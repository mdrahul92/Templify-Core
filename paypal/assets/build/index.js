!function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([,function(e,t,r){"use strict";function o(e){const t=document.getElementById("edd-paypal-pro-errors-wrap");t&&(t.innerHTML=e),jQuery(document.body).trigger("edd_checkout_error",[e])}function n(){jQuery(".edd-loading-ajax").remove();const e=document.getElementById("edd-purchase-button");if(e){e.disabled=!1;const t=e.getAttribute("data-original-value");t&&(e.value=t)}}function d(){const e=document.getElementById("card-holder-name");if(!e)return{};const t=window.getComputedStyle(e),r=document.createElement("style");return r.innerHTML=`\n\t\t\t#card-number,\n\t\t\t#expiration-date,\n\t\t\t#cvv {\n\t\t\t\tbackground-color: ${t.getPropertyValue("background-color")};\n\t\t\t\theight: ${e.offsetHeight}px;\n\n\t\t\t\t${["top","right","bottom","left"].map(e=>`border-${e}-color: ${t.getPropertyValue(`border-${e}-color`)};\n\t\t\t\t\t\t\t border-${e}-width: ${t.getPropertyValue(`border-${e}-width`)};\n\t\t\t\t\t\t\t border-${e}-style: ${t.getPropertyValue(`border-${e}-style`)};\n\t\t\t\t\t\t\t padding-${e}: ${t.getPropertyValue("padding-"+e)};`).join("")}\n\t\t\t\t${["top-right","bottom-right","bottom-left","top-left"].map(e=>`border-${e}-radius: ${t.getPropertyValue("border-top-right-radius")};`).join("")}\n\t\t\t}`.replace(/\s/g,""),r.id="edd-paypal-pro-element-styles",document.body.appendChild(r),{color:t.getPropertyValue("color"),"font-family":t.getPropertyValue("font-family"),"font-size":t.getPropertyValue("font-size"),"font-weight":t.getPropertyValue("font-weight"),"letter-spacing":t.getPropertyValue("letter-spacing"),"line-height":t.getPropertyValue("line-height")}}r.r(t),document.addEventListener("edd_paypal_buttons_mounted",()=>{const e=document.getElementById("edd-paypal-pro-cc-fields");e&&(paypal.HostedFields.isEligible()?(jQuery(document.body).on("edd_checkout_error",(e,t)=>{t.data&&o(t.data)}),function(){const e=document.getElementById("edd_purchase_form"),t=e.querySelector('input[name="edd_process_paypal_nonce"]');paypal.HostedFields.render({createOrder:()=>fetch(edd_scripts.ajaxurl,{method:"POST",body:new FormData(e)}).then((function(e){return e.json()})).then((function(e){if(e.data&&e.data.paypal_order_id)return e.data.nonce&&(t.value=e.data.nonce),e.data.paypal_order_id;var r=eddPayPalVars.defaultError;return e.data&&"string"==typeof e.data?r=e.data:"string"==typeof e&&(r=e),new Promise((function(e,t){t(new Error(r))}))})),styles:{input:d(),".invalid":{color:"red"}},fields:{number:{selector:"#card-number",placeholder:""},cvv:{selector:"#cvv",placeholder:""},expirationDate:{selector:"#expiration-date",placeholder:"MM/YY"}}}).then(t=>{jQuery("#edd_purchase_form").on("submit",r=>{(function(){let e="";const t=document.querySelector("input.edd-gateway:checked");if(t)e=t.value;else{const t=document.querySelector('meta[name="edd-chosen-gateway"]');t&&(e=t.getAttribute("content"))}return"paypal_commerce"===e})()&&(r.preventDefault(),function(){const e=document.getElementById("edd-paypal-pro-errors-wrap");e&&(e.innerHTML="")}(),t.submit({cardholderName:document.getElementById("card-holder-name").value,contingencies:["3D_SECURE"]}).then(t=>{if(function(e){return["NO","POSSIBLE"].includes(e.liabilityShift)}(t)&&!function(e){return e.liabilityShifted&&"POSSIBLE"===e.liabilityShift}(t))throw console.log("3DS Authentication Error",t),new Error(eddPayPalPro.threeDSecureError);const r=new FormData(e);return r.delete("action"),r.delete("edd_action"),r.append("action","edd_capture_paypal_order"),r.append("token",eddPayPalPro.token),r.append("timestamp",eddPayPalPro.timestamp),t.orderId&&r.append("paypal_order_id",t.orderId),fetch(edd_scripts.ajaxurl,{method:"POST",body:r})}).then((function(e){return e.json()})).then((function(e){e.success&&e.data.redirect_url?window.location=e.data.redirect_url:(n(),o(e.data.message?e.data.message:eddPayPalVars.defaultError))})).catch(e=>{if(console.log("Payment Error",e),n(),e.details&&Array.isArray(e.details)){const t=[];if(e.details.forEach(e=>{if(e.field&&e.description){let r="";-1!==e.field.indexOf("expiry")?r+=eddPayPalPro.prefixExpiration:-1!==e.field.indexOf("number")?r+=eddPayPalPro.prefixCardNumber:-1!==e.field.indexOf("security_code")&&(r+=eddPayPalPro.prefixCvv),r&&(r+=": "+e.description),t.push(r)}}),t.length)return void o(function(e){let t='<div class="edd_errors edd-alert edd-alert-error">';return e.forEach(e=>{t+='<p class="edd_error"><strong>'+eddPayPalPro.error+"</strong>: "+e+"</p>"}),t+="</div>",t}(t))}o(eddPayPalVars.defaultError)}))})})}()):e.style="display: none")})}]);